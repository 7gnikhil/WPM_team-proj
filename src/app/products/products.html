<div class="py-12 md:py-16 bg-gray-100">
  <div class="container mx-auto px-6">
    <div class="text-center mb-10">
      <h2 class="text-3xl font-bold text-gray-800">{{ title }}</h2>
      <p class="text-gray-600 mt-2">Explore our range of high-precision products and machinery.</p>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
      <div
        *ngFor="let product of filteredProducts"
        class="bg-white rounded-lg shadow-md overflow-hidden transform hover:-translate-y-1 transition-transform duration-300 flex flex-col cursor-pointer"
        (click)="openGallery(product)"
        role="button"
        [attr.aria-label]="product.gallery && product.gallery.length > 1 ? 'View gallery for ' + product.name : null"
      >
        <div class="relative">
          <img [src]="product.imageUrl" [alt]="product.name" class="w-full h-48 object-cover" />
          <div *ngIf="product.gallery && product.gallery.length > 1" class="absolute top-2 right-2 bg-black/60 text-white p-1.5 rounded-full backdrop-blur-sm" title="View gallery">
            <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
        </div>
        <div class="p-6 flex flex-col flex-grow">
          <div class="flex justify-between items-start">
            <h3 class="text-lg font-bold text-gray-800 mb-2 flex-1 pr-2">{{ product.name }}</h3>
            <span class="px-2 py-1 text-xs font-semibold rounded-full h-fit"
                  [class]="product.category === 'End Component' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'">
              {{ product.category }}
            </span>
          </div>
          <p class="text-gray-600 text-sm mb-4 flex-grow">{{ product.description }}</p>
          <p class="text-xs text-gray-400 mt-auto">Last Updated: {{ product.updatedAt | date:'shortDate' }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

    <!-- Lightbox / Gallery Modal -->
    <div *ngIf="activeProduct" (click)="closeGallery()" style="position:fixed; inset:0; background:rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center; z-index:50;">
      <div (click)="$event.stopPropagation()" style="background:#fff; border-radius:8px; box-shadow:0 10px 25px rgba(0,0,0,0.3); max-width:900px; width:90%; overflow:hidden;">
        <div style="position:relative; background:#000;">
          <img [src]="activeImages[activeIndex]" alt="" style="width:100%; height:400px; object-fit:contain; background:#000;" />
          <button (click)="closeGallery()" style="position:absolute; top:8px; right:8px; background:rgba(255,255,255,0.9); color:#111; border-radius:9999px; padding:4px 8px; border:none;">✕</button>
          <button (click)="prevImage($event)" style="position:absolute; left:8px; top:50%; transform:translateY(-50%); background:rgba(255,255,255,0.9); border-radius:9999px; padding:4px 10px; border:none;">‹</button>
          <button (click)="nextImage($event)" style="position:absolute; right:8px; top:50%; transform:translateY(-50%); background:rgba(255,255,255,0.9); border-radius:9999px; padding:4px 10px; border:none;">›</button>
        </div>
        <div class="p-4">
          <div class="text-sm text-gray-600">{{ activeIndex + 1 }} / {{ activeImages.length }}</div>
          <div style="display:flex; gap:8px; margin-top:8px; overflow-x:auto;">
            <img *ngFor="let img of activeImages; let i = index"
                 [src]="img"
                 [style.outline]="i === activeIndex ? '2px solid #2563eb' : '1px solid #e5e7eb'"
                 style="height:64px; width:64px; object-fit:cover; border-radius:4px; cursor:pointer;"
                 (click)="goTo(i, $event)" />
          </div>
        </div>
      </div>
    </div>

